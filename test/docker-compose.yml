# docker compose for performing unit testing and code sniff on code base.
version: "3.8"
services: 
    database:
        container_name: "pirogue-database-instance"
        image: mariadb:latest
        environment:
            - MYSQL_ROOT_PASSWORD=root-password
            - MYSQL_USER=website-user
            - MYSQL_PASSWORD=website-password
            - MYSQL_DATABASE=website
        volumes:
            - ./docker-entrypoint-initdb.d:/docker-entrypoint-initdb.d:ro
        ports:
            - 3306:3306        

    php-test:
        container_name: "pirogue-test-instance"
        image: "pirogue-test"
        build: .
        volumes:
            - ./test-unit:/var/pirogue/test:rw
            - ./test-config:/var/pirogue/config:ro
            - ./test-view:/var/pirogue/view:ro
            - ./test-lib:/var/pirogue/include/test:rw
            - ../src:/var/pirogue/include/pirogue:rw
        depends_on:
            - database
        links:
            - database        
